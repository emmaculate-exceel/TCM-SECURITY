# Defensive tooling

* This course is intended to be mostly vendor neutral
* Covers high level topics that would transfer to all or most vendors
+ Some labs will use specifics tools but only where there are free or open source versions .
+ Enterprise security tools = $$$


## Firewall

- Filter network traffic entering or exiting a network or computer
- physical or virtual, network or host based.
- Blocks unwanted or unsafe traffic
- Check Source and Destination IP Address, Port and Protocol.


## ACL (access control list) tables

Rule   Action(permit/deny)	 Protocol	Src IP(s)	Src Port Dest IP(s) Dest Port(s)

1	   Permit				 TCP    	<ip>/24		any		 Any  		80
2	   permit 				 TCP    	<ip>/24  	any		 any		443
3	   permit				 UDP		<ip>/24		any	     any		80
4 	   permit				 UDP		<ip>/24 	any		 any		443
5
6	   Deny					 Any(IP)	Any			any		 any		any

Note ACLs work based on heirachy

## Traditional vs Next Gen(NG)

- traditional firewals only filters on IPs, ports, and protocols.
- the above examples are for traditional firewalss
- newer firewalls called Next Gen or (NG) filter on many more factors.
- User identity and behaviours, threat intelligence, decryption, packet inspection, content filtering.


## IDS and IPS

- IDS = Intrusion detection systems only alerts
- IPS = Intrusion prevention detection systems - alerts and responds/prevents
- Can be host based or network based, mostly network based now.
- Network based work by inspecting more properties than what a firewall inspects.
- Uses signatures and sometimes behavioural/anomaly based detections.

## What endpoints detection and response (EDR)

- Significantly more advanced and capable form of endpoint protection
- Relies on multiple different sources of data (telemetry) to proactively detect and respond to treat.
- Examples of telemetry: file signatures, network connections, running processes, memory, kernel system or API calls, What files are opened or accessed.
- Telemetry is collected by a piece of software referred to as an agent which is installed on the endpoints (computers)
- the Agent may do some processing locally but most is done in a cloud based console or controller.

NOTE : EDR is an advance threat detection system .


## Security Information and Event Management (SIEM)

- Collects and aggregate logs from sources and tools like firewall, IDR/IPS, EDR, logs from services, cloud tools, threat intel.

- Creates a single place to alert on, view on, report and action incidents or events from all of the security relevant sources and tools within a business or organization.
- SIEM can be tuned to provide different levels of alert based on the input to it or correllations of multiple inputs.
- Aggregating multiple source of information together provides for hight quality alerts and paints a clearer picture for security staff
- sometimes referred to as a single pane of glass
- provides reportss and is crittical for compliance
- Can be used for threat hunting and in-dept log analysis

## Defense in-depth

- No security tools or control is perfect
- Where one fails another may prevails
- Attackers are frequently looking for the easiest target - multiple defenses is a deterrent
- provides redundancy in case of complete control failure.


## The confusion Matrix


The four states of the matrix are:

True Positive: the test correctly detected the presence of what it was testing for, in cybersecurity this means it properly detected malicious activity.

True Negative: the test correctly detected the absence of what it was testing for, in cybersecurity this means it properly detected normal activity.

False Positive: the test incorrectly detected the presence of what it was testing for, in cybersecurity this means that it classified normal (sometimes referred to as benign) activity as malicious. False positives can be a nuisance and also use up resources for security teams to triage. Detection tools are frequently tuned to reduce the amount of false positives they produce.

False Negative: the test incorrectly detected the absence of what it was testing for, in cybersecurity this means that it classified malicious activity as normal (benign). False negatives are much more dangerous than false positives as they mean that malicious activity went undetected by the system. When tuning detection systems to reduce false positives it is important to not over tune and introduce false negatives.

